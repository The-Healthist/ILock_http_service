basePath: /api
definitions:
  controllers.BuildingRequest:
    properties:
      address:
        example: 小区东南角
        type: string
      building_code:
        example: B001
        type: string
      building_name:
        example: 1号楼
        type: string
      status:
        description: active, inactive
        example: active
        type: string
    required:
    - building_code
    - building_name
    type: object
  controllers.CallActionRequest:
    properties:
      call_info:
        $ref: '#/definitions/controllers.CallInfo'
    required:
    - call_info
    type: object
  controllers.CallFeedbackRequest:
    properties:
      comment:
        description: 可选评论
        example: 通话质量良好，声音清晰
        type: string
      issues:
        description: 问题描述
        example: 偶尔有一点延迟
        type: string
      rating:
        description: 1-5 星评分
        example: 4
        maximum: 5
        minimum: 1
        type: integer
    required:
    - rating
    type: object
  controllers.CallInfo:
    properties:
      action:
        example: answered
        type: string
      call_id:
        example: call-20250510-abcdef123456
        type: string
      reason:
        example: user_busy
        type: string
      timestamp:
        example: 1651234567890
        type: integer
    type: object
  controllers.CallRequest:
    properties:
      device_id:
        type: string
      resident_id:
        type: string
    required:
    - device_id
    - resident_id
    type: object
  controllers.CallSessionResponse:
    properties:
      call_id:
        example: call-20250510-abcdef123456
        type: string
      device_id:
        example: "1"
        type: string
      last_activity:
        example: "2025-05-10T15:09:10Z"
        type: string
      resident_id:
        example: "2"
        type: string
      start_time:
        example: "2025-05-10T15:04:05Z"
        type: string
      status:
        example: connected
        type: string
      tencen_rtc:
        $ref: '#/definitions/controllers.TRTCInfo'
    type: object
  controllers.CreateAdminRequest:
    properties:
      email:
        example: admin@example.com
        type: string
      password:
        example: Admin@123
        type: string
      phone:
        example: "13800138000"
        type: string
      username:
        example: admin123
        type: string
    required:
    - email
    - password
    - phone
    - username
    type: object
  controllers.CreateStaffRequest:
    properties:
      device_ids:
        description: 关联的设备ID列表
        example:
        - 1
        - 2
        - 3
        items:
          type: integer
        type: array
      name:
        description: '注意: 已从模型中移除，但保留请求结构以兼容前端'
        example: 王物业
        type: string
      password:
        example: Property@123
        type: string
      phone:
        example: "13700001234"
        type: string
      position:
        example: 物业经理
        type: string
      property_name:
        example: 阳光花园小区
        type: string
      remark:
        example: 负责A区日常管理工作
        type: string
      role:
        description: '可选值: manager, staff, security'
        example: manager
        type: string
      status:
        description: '可选值: active, inactive, suspended'
        example: active
        type: string
      username:
        example: wangwuye
        type: string
    required:
    - password
    - phone
    - role
    - username
    type: object
  controllers.DeviceBuildingRequest:
    properties:
      building_id:
        example: 1
        type: integer
    required:
    - building_id
    type: object
  controllers.DeviceHealthRequest:
    properties:
      device_id:
        example: "1"
        type: string
    required:
    - device_id
    type: object
  controllers.DeviceHouseholdRequest:
    properties:
      household_id:
        example: 1
        type: integer
    required:
    - household_id
    type: object
  controllers.DeviceRequestInput:
    properties:
      building_id:
        description: 关联的楼号ID
        example: 1
        type: integer
      household_ids:
        description: 关联的户号ID列表
        example:
        - 1
        - 2
        items:
          type: integer
        type: array
      location:
        example: 小区北门入口
        type: string
      name:
        example: 门禁1号
        type: string
      serial_number:
        example: SN12345678
        type: string
      staff_ids:
        description: 关联的物业员工ID列表
        example:
        - 1
        - 2
        - 3
        items:
          type: integer
        type: array
      status:
        description: online, offline, fault
        example: online
        type: string
    required:
    - name
    - serial_number
    type: object
  controllers.EmergencyAlarmRequest:
    properties:
      description:
        example: 火灾警报被触发，疑似厨房起火
        type: string
      location:
        example: Building A, Floor 3
        type: string
      property_id:
        description: 物业ID
        example: 1
        type: integer
      reported_by:
        description: 报告人ID
        example: 1
        type: integer
      type:
        description: 如：fire(火灾)、intrusion(入侵)、medical(医疗)等
        example: fire
        type: string
    required:
    - location
    - property_id
    - type
    type: object
  controllers.EmergencyNotificationRequest:
    properties:
      content:
        example: A栋3楼发生火灾，请所有居民立即疏散。
        type: string
      expires_at:
        description: 可选，不提供则默认24小时
        example: "2023-07-01T15:00:00Z"
        type: string
      is_public:
        description: 是否为公开通知
        example: false
        type: boolean
      property_id:
        description: 关联的物业ID，可以为空表示全局通知
        example: 1
        type: integer
      severity:
        description: high, medium, low
        example: high
        type: string
      target_type:
        description: all, residents, staff
        example: all
        type: string
      title:
        example: 紧急通知：小区火灾警报
        type: string
    required:
    - content
    - severity
    - title
    type: object
  controllers.EmergencyUnlockRequest:
    properties:
      reason:
        example: 火灾疏散
        type: string
    required:
    - reason
    type: object
  controllers.EndCallSessionRequest:
    properties:
      call_id:
        example: call-20250510-abcdef123456
        type: string
      reason:
        example: call_completed
        type: string
    required:
    - call_id
    type: object
  controllers.ErrorResponse:
    properties:
      code:
        example: 401
        type: integer
      data: {}
      message:
        example: Invalid username or password
        type: string
    type: object
  controllers.GetUserSigRequest:
    properties:
      user_id:
        example: user123
        type: string
    required:
    - user_id
    type: object
  controllers.HouseholdDeviceRequest:
    properties:
      device_id:
        example: 1
        type: integer
    required:
    - device_id
    type: object
  controllers.HouseholdRequest:
    properties:
      building_id:
        example: 1
        type: integer
      household_number:
        example: 1-1-101
        type: string
      status:
        description: active, inactive
        example: active
        type: string
    required:
    - building_id
    - household_number
    type: object
  controllers.InitiateCallRequest:
    properties:
      device_device_id:
        description: 使用与MQTT通讯中相同的字段名
        example: "1"
        type: string
      household_id:
        description: 可选，指定户号ID
        example: "1"
        type: string
      resident_phone:
        description: 可选，通过住户电话呼叫
        example: "13800138000"
        type: string
      target_resident_id:
        description: 可选，如不提供则会通知所有关联的居民
        type: string
      timestamp:
        description: 可选时间戳
        example: 1651234567890
        type: integer
    required:
    - device_device_id
    type: object
  controllers.InitiateCallResponse:
    properties:
      call_id:
        example: call-20250510-abcdef123456
        type: string
      call_info:
        $ref: '#/definitions/controllers.CallInfo'
      device_device_id:
        example: "1"
        type: string
      target_resident_ids:
        example:
        - '["2"'
        - '"3"]'
        items:
          type: string
        type: array
      tencen_rtc:
        $ref: '#/definitions/controllers.TRTCInfo'
      timestamp:
        example: 1651234567890
        type: integer
    type: object
  controllers.LoginData:
    properties:
      created_at:
        example: "2023-01-01T00:00:00Z"
        type: string
      role:
        example: admin
        type: string
      token:
        example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        type: string
      user_id:
        example: 1
        type: integer
      username:
        example: admin
        type: string
    type: object
  controllers.LoginRequest:
    properties:
      password:
        example: admin123
        type: string
      username:
        example: admin
        type: string
    required:
    - password
    - username
    type: object
  controllers.LoginResponse:
    properties:
      code:
        example: 0
        type: integer
      data: {}
      message:
        example: Login successful
        type: string
    type: object
  controllers.PublishDeviceStatusRequest:
    properties:
      battery:
        example: 85
        type: integer
      device_id:
        example: "1"
        type: string
      online:
        example: true
        type: boolean
      properties:
        additionalProperties: true
        type: object
    required:
    - device_id
    type: object
  controllers.PublishSystemMessageRequest:
    properties:
      data:
        additionalProperties: true
        type: object
      level:
        example: info
        type: string
      message:
        example: 系统将于今晚22:00进行升级维护
        type: string
      timestamp:
        example: 1651234567890
        type: integer
      type:
        example: notification
        type: string
    required:
    - level
    - message
    - type
    type: object
  controllers.ResidentRequest:
    properties:
      device_id:
        example: 101
        type: integer
      email:
        example: zhangsan@resident.com
        type: string
      name:
        example: 张三
        type: string
      phone:
        example: "13812345678"
        type: string
    required:
    - device_id
    - name
    - phone
    type: object
  controllers.TRTCInfo:
    properties:
      room_id:
        example: call_room_12345
        type: string
      room_id_type:
        example: string
        type: string
      sdk_app_id:
        example: 1400000001
        type: integer
      user_id:
        example: device_1
        type: string
      user_sig:
        example: eJwtzM1Og0AUhmG...
        type: string
    type: object
  controllers.TencentCallRequest:
    properties:
      device_id:
        type: string
      resident_id:
        type: string
    required:
    - device_id
    - resident_id
    type: object
  controllers.TokenRequest:
    properties:
      channel_id:
        example: room123
        type: string
      user_id:
        example: user456
        type: string
    required:
    - channel_id
    - user_id
    type: object
  controllers.UpdateAdminRequest:
    properties:
      email:
        example: admin@example.com
        type: string
      password:
        example: NewPassword@123
        type: string
      phone:
        example: "13800138000"
        type: string
    type: object
  controllers.UpdateResidentRequest:
    properties:
      device_id:
        example: 102
        type: integer
      email:
        example: lisi@resident.com
        type: string
      name:
        example: 李四
        type: string
      phone:
        example: "13987654321"
        type: string
    type: object
  controllers.UpdateStaffRequest:
    properties:
      device_ids:
        description: 更新关联的设备ID列表
        example:
        - 1
        - 3
        - 5
        items:
          type: integer
        type: array
      name:
        example: 李物业
        type: string
      password:
        example: NewProperty@456
        type: string
      phone:
        example: "13700005678"
        type: string
      position:
        example: 前台客服
        type: string
      property_name:
        example: 幸福家园小区
        type: string
      remark:
        example: 负责接待访客和处理居民投诉
        type: string
      role:
        description: '可选值: manager, staff, security'
        example: staff
        type: string
      status:
        description: '可选值: active, inactive, suspended'
        example: active
        type: string
      username:
        example: liwuye
        type: string
    type: object
  models.AccessLog:
    properties:
      device:
        allOf:
        - $ref: '#/definitions/models.Device'
        description: Relations
      device_id:
        type: integer
      id:
        type: integer
      method:
        $ref: '#/definitions/models.AccessMethod'
      resident:
        $ref: '#/definitions/models.Resident'
      resident_id:
        type: integer
      result:
        $ref: '#/definitions/models.AccessResult'
      timestamp:
        type: string
    type: object
  models.AccessMethod:
    enum:
    - remote
    - code
    - face
    - fingerprint
    type: string
    x-enum-varnames:
    - AccessMethodRemote
    - AccessMethodCode
    - AccessMethodFace
    - AccessMethodFingerprint
  models.AccessResult:
    enum:
    - success
    - failure
    type: string
    x-enum-varnames:
    - AccessResultSuccess
    - AccessResultFailure
  models.Building:
    properties:
      address:
        description: 楼号地址，如"小区东南角"
        type: string
      building_code:
        description: 楼号编码，如"B001"
        type: string
      building_name:
        description: 楼号名称，如"1号楼"
        type: string
      created_at:
        type: string
      devices:
        description: 楼号关联的设备（一对多）
        items:
          $ref: '#/definitions/models.Device'
        type: array
      households:
        description: 关联关系
        items:
          $ref: '#/definitions/models.Household'
        type: array
      id:
        type: integer
      status:
        description: 状态：active, inactive
        type: string
      updated_at:
        type: string
    type: object
  models.CallRecord:
    properties:
      call_id:
        description: 通话唯一标识
        type: string
      call_status:
        $ref: '#/definitions/models.CallStatus'
      created_at:
        type: string
      device:
        allOf:
        - $ref: '#/definitions/models.Device'
        description: Relations
      device_id:
        type: integer
      duration:
        description: 通话时长
        type: integer
      id:
        type: integer
      resident:
        $ref: '#/definitions/models.Resident'
      resident_id:
        type: integer
      timestamp:
        description: 通话开始时间
        type: string
      updated_at:
        type: string
    type: object
  models.CallStatus:
    enum:
    - answered
    - missed
    - timeout
    type: string
    x-enum-varnames:
    - CallStatusAnswered
    - CallStatusMissed
    - CallStatusTimeout
  models.Device:
    properties:
      access_logs:
        items:
          $ref: '#/definitions/models.AccessLog'
        type: array
      building:
        allOf:
        - $ref: '#/definitions/models.Building'
        description: 关联的楼号（多对一）
      building_id:
        description: 关联的楼号ID
        type: integer
      call_records:
        items:
          $ref: '#/definitions/models.CallRecord'
        type: array
      created_at:
        type: string
      emergency_logs:
        items:
          $ref: '#/definitions/models.EmergencyLog'
        type: array
      household:
        allOf:
        - $ref: '#/definitions/models.Household'
        description: 关联的户号（多对一）
      household_id:
        description: 关联的户号ID
        type: integer
      id:
        type: integer
      location:
        type: string
      name:
        type: string
      residents:
        description: 关联的居民（一对多）
        items:
          $ref: '#/definitions/models.Resident'
        type: array
      serial_number:
        type: string
      staff:
        description: Relations - 关联关系
        items:
          $ref: '#/definitions/models.PropertyStaff'
        type: array
      status:
        $ref: '#/definitions/models.DeviceStatus'
      updated_at:
        type: string
    type: object
  models.DeviceStatus:
    enum:
    - online
    - offline
    - fault
    type: string
    x-enum-varnames:
    - DeviceStatusOnline
    - DeviceStatusOffline
    - DeviceStatusFault
  models.EmergencyLog:
    properties:
      device:
        allOf:
        - $ref: '#/definitions/models.Device'
        description: Relations
      device_id:
        type: integer
      id:
        type: integer
      resident:
        $ref: '#/definitions/models.Resident'
      resident_id:
        type: integer
      resolved_at:
        description: 可空字段
        type: string
      status:
        $ref: '#/definitions/models.EmergencyStatus'
      triggered_at:
        type: string
    type: object
  models.EmergencyStatus:
    enum:
    - pending
    - responded
    - escalated
    - resolved
    type: string
    x-enum-varnames:
    - EmergencyStatusPending
    - EmergencyStatusResponded
    - EmergencyStatusEscalated
    - EmergencyStatusResolved
  models.Household:
    properties:
      building:
        allOf:
        - $ref: '#/definitions/models.Building'
        description: Relations - 关联关系
      building_id:
        description: 关联的楼号ID
        type: integer
      created_at:
        type: string
      devices:
        description: 关联的设备（一对多）
        items:
          $ref: '#/definitions/models.Device'
        type: array
      household_number:
        description: 户号编号，如"1-1-101"
        type: string
      id:
        type: integer
      residents:
        description: 关联的居民（一对多）
        items:
          $ref: '#/definitions/models.Resident'
        type: array
      status:
        description: 状态：active, inactive
        type: string
      updated_at:
        type: string
    type: object
  models.PropertyStaff:
    properties:
      created_at:
        type: string
      devices:
        description: 关联关系 - 使用多对多关系替代直接关联
        items:
          $ref: '#/definitions/models.Device'
        type: array
      id:
        type: integer
      phone:
        type: string
      position:
        type: string
      property_name:
        type: string
      remark:
        type: string
      role:
        description: manager, staff, etc.
        type: string
      status:
        type: string
      updated_at:
        type: string
      username:
        type: string
    type: object
  models.Resident:
    properties:
      access_logs:
        items:
          $ref: '#/definitions/models.AccessLog'
        type: array
      call_records:
        items:
          $ref: '#/definitions/models.CallRecord'
        type: array
      created_at:
        type: string
      device:
        allOf:
        - $ref: '#/definitions/models.Device'
        description: Relations
      device_id:
        description: 关联的设备ID
        type: integer
      email:
        type: string
      emergency_logs:
        items:
          $ref: '#/definitions/models.EmergencyLog'
        type: array
      household:
        allOf:
        - $ref: '#/definitions/models.Household'
        description: 所属户号
      household_id:
        description: 关联的户号ID
        type: integer
      id:
        type: integer
      name:
        type: string
      phone:
        type: string
      updated_at:
        type: string
    type: object
host: 39.108.49.167:20033
info:
  contact:
    email: support@yourcompany.com
    name: API Support
    url: http://www.yourcompany.com/support
  description: A comprehensive door access management system with video calling capabilities
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  termsOfService: http://swagger.io/terms/
  title: ILock HTTP Service API
  version: "1.0"
paths:
  /admins:
    get:
      consumes:
      - application/json
      description: 分页获取所有管理员用户列表
      parameters:
      - description: 页码, 默认为1
        in: query
        name: page
        type: integer
      - description: 每页条数, 默认为10
        in: query
        name: page_size
        type: integer
      - description: 搜索关键词(用户名、电话等)
        in: query
        name: search
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取管理员列表
      tags:
      - Admin
    post:
      consumes:
      - application/json
      description: 创建一个新的管理员用户
      parameters:
      - description: 管理员信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.CreateAdminRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 创建管理员
      tags:
      - Admin
  /admins/{id}:
    delete:
      consumes:
      - application/json
      description: 删除指定ID的管理员用户
      parameters:
      - description: 管理员ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 删除管理员
      tags:
      - Admin
    get:
      consumes:
      - application/json
      description: 根据ID获取特定管理员的详细信息
      parameters:
      - description: 管理员ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取管理员详情
      tags:
      - Admin
    put:
      consumes:
      - application/json
      description: 更新现有管理员用户的信息
      parameters:
      - description: 管理员ID
        in: path
        name: id
        required: true
        type: integer
      - description: 更新的管理员信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.UpdateAdminRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新管理员
      tags:
      - Admin
  /api/rtc/call:
    post:
      consumes:
      - application/json
      description: Initiate a video call between a device and a resident
      parameters:
      - description: Call request parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.CallRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      summary: Start Video Call
      tags:
      - RTC
  /api/rtc/token:
    post:
      consumes:
      - application/json
      description: Get a RTC token for real-time communication
      parameters:
      - description: Token request parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.TokenRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      summary: Get RTC Token
      tags:
      - RTC
  /auth/login:
    post:
      consumes:
      - application/json
      description: Process user login and return JWT token with different permissions
        based on user role
      parameters:
      - description: Login request parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Success response with token
          schema:
            allOf:
            - $ref: '#/definitions/controllers.LoginResponse'
            - properties:
                data:
                  $ref: '#/definitions/controllers.LoginData'
              type: object
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      summary: User Login
      tags:
      - Auth
  /buildings:
    get:
      consumes:
      - application/json
      description: 获取系统中所有楼号的列表
      parameters:
      - description: 页码，默认为1
        in: query
        name: page
        type: integer
      - description: 每页条数，默认为10
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取所有楼号
      tags:
      - Building
    post:
      consumes:
      - application/json
      description: 创建一个新的楼号
      parameters:
      - description: 楼号信息
        in: body
        name: building
        required: true
        schema:
          $ref: '#/definitions/controllers.BuildingRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 创建楼号
      tags:
      - Building
  /buildings/{id}:
    delete:
      consumes:
      - application/json
      description: 删除指定的楼号
      parameters:
      - description: 楼号ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 删除楼号
      tags:
      - Building
    get:
      consumes:
      - application/json
      description: 根据ID获取楼号详细信息
      parameters:
      - description: 楼号ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取楼号详情
      tags:
      - Building
    put:
      consumes:
      - application/json
      description: 更新楼号信息
      parameters:
      - description: 楼号ID
        in: path
        name: id
        required: true
        type: integer
      - description: 楼号信息
        in: body
        name: building
        required: true
        schema:
          $ref: '#/definitions/controllers.BuildingRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新楼号
      tags:
      - Building
  /buildings/{id}/devices:
    get:
      consumes:
      - application/json
      description: 获取指定楼号关联的所有设备
      parameters:
      - description: 楼号ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取楼号关联的设备
      tags:
      - Building
  /buildings/{id}/households:
    get:
      consumes:
      - application/json
      description: 获取指定楼号下的所有户号
      parameters:
      - description: 楼号ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取楼号下的户号
      tags:
      - Building
  /call_records:
    get:
      consumes:
      - application/json
      description: 获取系统中所有通话记录，支持分页
      parameters:
      - description: 页码，默认为1
        in: query
        name: page
        type: integer
      - description: 每页条数，默认为10
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取通话记录列表
      tags:
      - CallRecord
  /call_records/{id}:
    get:
      consumes:
      - application/json
      description: 根据ID获取特定通话记录的详细信息
      parameters:
      - description: 通话记录ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取通话记录详情
      tags:
      - CallRecord
  /call_records/{id}/feedback:
    post:
      consumes:
      - application/json
      description: 为特定通话记录提交质量反馈
      parameters:
      - description: 通话记录ID
        in: path
        name: id
        required: true
        type: integer
      - description: 反馈信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.CallFeedbackRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 提交通话反馈
      tags:
      - CallRecord
  /call_records/device/{deviceId}:
    get:
      consumes:
      - application/json
      description: 获取特定设备的通话记录，支持分页
      parameters:
      - description: 设备ID
        in: path
        name: deviceId
        required: true
        type: integer
      - description: 页码，默认为1
        in: query
        name: page
        type: integer
      - description: 每页条数，默认为10
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取设备通话记录
      tags:
      - CallRecord
  /call_records/resident/{residentId}:
    get:
      consumes:
      - application/json
      description: 获取特定居民的通话记录，支持分页
      parameters:
      - description: 居民ID
        in: path
        name: residentId
        required: true
        type: integer
      - description: 页码，默认为1
        in: query
        name: page
        type: integer
      - description: 每页条数，默认为10
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取居民通话记录
      tags:
      - CallRecord
  /call_records/session:
    get:
      consumes:
      - application/json
      description: 通过CallID（MQTT会话ID）获取特定通话记录的详细信息
      parameters:
      - description: 通话会话ID（UUID）
        in: query
        name: call_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 通过CallID获取通话记录
      tags:
      - CallRecord
  /call_records/statistics:
    get:
      consumes:
      - application/json
      description: 获取通话统计信息，包括总数、已接、未接等
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取通话统计信息
      tags:
      - CallRecord
  /device/status:
    post:
      consumes:
      - application/json
      description: 设备用于报告在线状态的简单健康检测接口
      parameters:
      - description: 设备健康检测请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.DeviceHealthRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 设备健康检测
      tags:
      - device
  /devices:
    get:
      consumes:
      - application/json
      description: 获取所有设备的列表，支持按楼号筛选
      parameters:
      - description: 楼号ID
        in: query
        name: building_id
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Device'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取所有设备
      tags:
      - device
    post:
      consumes:
      - application/json
      description: 创建一个新的门禁设备，支持设备类型和关联
      parameters:
      - description: 设备信息：包含名称、类型、位置、关联楼号/户号等
        in: body
        name: device
        required: true
        schema:
          $ref: '#/definitions/controllers.DeviceRequestInput'
      produces:
      - application/json
      responses:
        "201":
          description: 成功创建的设备信息
          schema:
            $ref: '#/definitions/models.Device'
        "400":
          description: 请求参数错误，如缺少必填字段或格式不正确
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: 服务器内部错误，可能是数据库操作失败等
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 创建新设备
      tags:
      - device
  /devices/{id}:
    delete:
      consumes:
      - application/json
      description: 根据ID删除设备
      parameters:
      - description: 设备ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 删除设备
      tags:
      - device
    get:
      consumes:
      - application/json
      description: 根据ID获取设备信息
      parameters:
      - description: 设备ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Device'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取单个设备
      tags:
      - device
    put:
      consumes:
      - application/json
      description: 根据ID更新设备信息，支持更新关联
      parameters:
      - description: 设备ID
        in: path
        name: id
        required: true
        type: string
      - description: 设备信息：包含需要更新的字段
        in: body
        name: device
        required: true
        schema:
          $ref: '#/definitions/controllers.DeviceRequestInput'
      produces:
      - application/json
      responses:
        "200":
          description: 更新后的设备信息
          schema:
            $ref: '#/definitions/models.Device'
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: 设备不存在
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新设备信息
      tags:
      - device
  /devices/{id}/building:
    post:
      consumes:
      - application/json
      description: 将指定设备关联到楼号
      parameters:
      - description: 设备ID
        in: path
        name: id
        required: true
        type: integer
      - description: 楼号信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.DeviceBuildingRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 关联设备与楼号
      tags:
      - device
  /devices/{id}/households:
    get:
      consumes:
      - application/json
      description: 获取指定设备关联的所有户号
      parameters:
      - description: 设备ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取设备关联的户号
      tags:
      - device
    post:
      consumes:
      - application/json
      description: 将指定设备关联到户号
      parameters:
      - description: 设备ID
        in: path
        name: id
        required: true
        type: integer
      - description: 户号信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.DeviceHouseholdRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 关联设备与户号
      tags:
      - device
  /devices/{id}/households/{household_id}:
    delete:
      consumes:
      - application/json
      description: 解除指定设备与户号的关联
      parameters:
      - description: 设备ID
        in: path
        name: id
        required: true
        type: integer
      - description: 户号ID
        in: path
        name: household_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 解除设备与户号的关联
      tags:
      - device
  /devices/{id}/status:
    get:
      consumes:
      - application/json
      description: 获取设备的当前状态信息，包括在线状态、最后更新时间等
      parameters:
      - description: 设备ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: 设备状态信息，包含ID、名称、状态、位置、最后在线时间等
          schema:
            additionalProperties: true
            type: object
        "404":
          description: 设备不存在
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: 服务器内部错误，可能是数据库查询失败等
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取设备状态
      tags:
      - device
  /emergency/alarm:
    post:
      consumes:
      - application/json
      description: Trigger an emergency alarm and notify relevant personnel
      parameters:
      - description: Alarm request parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.EmergencyAlarmRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Trigger Emergency Alarm
      tags:
      - Emergency
  /emergency/contacts:
    get:
      consumes:
      - application/json
      description: Get a list of all emergency contacts in the system
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get Emergency Contacts
      tags:
      - Emergency
  /emergency/notify-all:
    post:
      consumes:
      - application/json
      description: Send notification to all users during an emergency
      parameters:
      - description: Notification request parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.EmergencyNotificationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Notify All Users
      tags:
      - Emergency
  /emergency/unlock-all:
    post:
      consumes:
      - application/json
      description: Unlock all doors in the system during an emergency
      parameters:
      - description: Unlock request parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.EmergencyUnlockRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Emergency Unlock All Doors
      tags:
      - Emergency
  /households:
    get:
      consumes:
      - application/json
      description: 获取系统中所有户号的列表
      parameters:
      - description: 页码，默认为1
        in: query
        name: page
        type: integer
      - description: 每页条数，默认为10
        in: query
        name: page_size
        type: integer
      - description: 楼号ID，用于筛选特定楼号下的户号
        in: query
        name: building_id
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取所有户号
      tags:
      - Household
    post:
      consumes:
      - application/json
      description: 创建一个新的户号，需要关联到楼号
      parameters:
      - description: 户号信息
        in: body
        name: household
        required: true
        schema:
          $ref: '#/definitions/controllers.HouseholdRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 创建户号
      tags:
      - Household
  /households/{id}:
    delete:
      consumes:
      - application/json
      description: 删除指定的户号
      parameters:
      - description: 户号ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 删除户号
      tags:
      - Household
    get:
      consumes:
      - application/json
      description: 根据ID获取户号详细信息
      parameters:
      - description: 户号ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取户号详情
      tags:
      - Household
    put:
      consumes:
      - application/json
      description: 更新户号信息
      parameters:
      - description: 户号ID
        in: path
        name: id
        required: true
        type: integer
      - description: 户号信息
        in: body
        name: household
        required: true
        schema:
          $ref: '#/definitions/controllers.HouseholdRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新户号
      tags:
      - Household
  /households/{id}/devices:
    get:
      consumes:
      - application/json
      description: 获取指定户号关联的所有设备
      parameters:
      - description: 户号ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取户号关联的设备
      tags:
      - Household
    post:
      consumes:
      - application/json
      description: 将指定户号关联到设备
      parameters:
      - description: 户号ID
        in: path
        name: id
        required: true
        type: integer
      - description: 设备信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.HouseholdDeviceRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 关联户号与设备
      tags:
      - Household
  /households/{id}/devices/{device_id}:
    delete:
      consumes:
      - application/json
      description: 解除指定户号与设备的关联
      parameters:
      - description: 户号ID
        in: path
        name: id
        required: true
        type: integer
      - description: 设备ID
        in: path
        name: device_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 解除户号与设备的关联
      tags:
      - Household
  /households/{id}/residents:
    get:
      consumes:
      - application/json
      description: 获取指定户号下的所有居民
      parameters:
      - description: 户号ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取户号下的居民
      tags:
      - Household
  /mqtt/call:
    post:
      consumes:
      - application/json
      description: 通过MQTT向设备或住户发起视频通话请求，支持三种调用方式：1.通过住户电话呼叫；2.通过指定户号呼叫；3.通过设备关联的户号呼叫
      parameters:
      - description: 通话请求参数：支持device_device_id(必填)、household_id(可选)、target_resident_id(可选)、resident_phone(可选)参数
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.InitiateCallRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controllers.InitiateCallResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      summary: 发起MQTT通话
      tags:
      - MQTT
  /mqtt/controller/device:
    post:
      consumes:
      - application/json
      description: 处理设备端通话动作，支持的动作类型包括：hangup(挂断)、cancelled(取消呼叫)
      parameters:
      - description: 设备通话动作请求，包含call_id和action字段
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.CallActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      summary: 处理MQTT呼叫方动作
      tags:
      - MQTT
  /mqtt/controller/resident:
    post:
      consumes:
      - application/json
      description: 处理居民端通话动作，支持的动作类型包括：rejected(拒绝)、answered(接听)、hangup(挂断)、timeout(超时)
      parameters:
      - description: 居民通话动作请求，包含call_id、action和可选的reason字段
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.CallActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      summary: 处理MQTT被呼叫方动作
      tags:
      - MQTT
  /mqtt/device/status:
    post:
      consumes:
      - application/json
      description: 更新设备状态信息，包括在线状态、电池电量和其他自定义属性，无需MQTT连接，系统会通过MQTT推送给相关订阅方
      parameters:
      - description: 设备状态信息：必须包含device_id、online、battery字段，可选包含properties自定义属性
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.PublishDeviceStatusRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      summary: 更新设备状态
      tags:
      - Device
  /mqtt/end-session:
    post:
      consumes:
      - application/json
      description: 强制结束通话会话并通知所有参与方，适用于系统管理或异常情况下的通话强制终止
      parameters:
      - description: 结束通话会话请求，包含call_id和可选的reason字段
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.EndCallSessionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      summary: 结束MQTT通话会话
      tags:
      - MQTT
  /mqtt/session:
    get:
      consumes:
      - application/json
      description: 获取通话会话信息及TRTC房间详情，包括设备ID、住户ID、通话状态、开始时间等
      parameters:
      - description: 通话会话ID
        in: query
        name: call_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controllers.CallSessionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      summary: 获取MQTT通话会话
      tags:
      - MQTT
  /mqtt/system/message:
    post:
      consumes:
      - application/json
      description: 通过MQTT发布系统消息，支持info、warning、error三种级别，消息会推送给所有订阅相关主题的客户端
      parameters:
      - description: 系统消息信息：必须包含type、level、message字段，level支持info、warning、error三种级别
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.PublishSystemMessageRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      summary: 发布系统消息
      tags:
      - MQTT
  /residents:
    get:
      consumes:
      - application/json
      description: 获取系统中所有居民的列表
      parameters:
      - description: 页码，默认为1
        in: query
        name: page
        type: integer
      - description: 每页条数，默认为10
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取居民列表
      tags:
      - Resident
    post:
      consumes:
      - application/json
      description: 创建新的居民账户，需要关联到特定设备
      parameters:
      - description: 居民信息 - 姓名、电话和设备ID为必填，邮箱可选
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.ResidentRequest'
      produces:
      - application/json
      responses:
        "201":
          description: 成功响应，包含创建的居民详情
          schema:
            additionalProperties: true
            type: object
        "400":
          description: 请求错误，设备不存在或电话号码已被使用
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: 服务器错误
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 创建居民
      tags:
      - Resident
  /residents/{id}:
    delete:
      consumes:
      - application/json
      description: 删除指定ID的居民
      parameters:
      - description: 居民ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 删除居民
      tags:
      - Resident
    get:
      consumes:
      - application/json
      description: 根据ID获取特定居民的详细信息
      parameters:
      - description: 居民ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取居民详情
      tags:
      - Resident
    put:
      consumes:
      - application/json
      description: 更新现有居民的信息
      parameters:
      - description: 居民ID
        in: path
        name: id
        required: true
        type: integer
      - description: 更新的居民信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.UpdateResidentRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新居民
      tags:
      - Resident
  /staffs:
    get:
      consumes:
      - application/json
      description: 获取所有物业员工的列表，支持分页和搜索
      parameters:
      - description: 页码，默认为1
        in: query
        name: page
        type: integer
      - description: 每页条数，默认为10
        in: query
        name: page_size
        type: integer
      - description: 搜索关键词(姓名、电话等)
        in: query
        name: search
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取物业员工列表
      tags:
      - Staff
    post:
      consumes:
      - application/json
      description: 创建一个新的物业员工
      parameters:
      - description: 物业员工信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.CreateStaffRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 创建物业员工
      tags:
      - Staff
  /staffs/{id}:
    delete:
      consumes:
      - application/json
      description: 删除指定ID的物业员工
      parameters:
      - description: 物业员工ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 删除物业员工
      tags:
      - Staff
    get:
      consumes:
      - application/json
      description: 根据ID获取特定物业员工的详细信息
      parameters:
      - description: 物业员工ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取物业员工详情
      tags:
      - Staff
    put:
      consumes:
      - application/json
      description: 更新现有物业员工的信息
      parameters:
      - description: 物业员工ID
        in: path
        name: id
        required: true
        type: integer
      - description: 更新的物业员工信息
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.UpdateStaffRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 更新物业员工
      tags:
      - Staff
  /staffs/with-devices:
    get:
      consumes:
      - application/json
      description: 获取所有物业员工的列表及其关联的设备信息
      parameters:
      - description: 页码，默认为1
        in: query
        name: page
        type: integer
      - description: 每页条数，默认为10
        in: query
        name: page_size
        type: integer
      - description: 搜索关键词(姓名、电话等)
        in: query
        name: search
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      security:
      - BearerAuth: []
      summary: 获取带设备信息的物业员工列表
      tags:
      - Staff
  /trtc/call:
    post:
      consumes:
      - application/json
      description: Initiate a Tencent Cloud video call between a device and a resident
      parameters:
      - description: Call request parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.TencentCallRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      summary: Start Tencent Video Call
      tags:
      - TencentRTC
  /trtc/usersig:
    post:
      consumes:
      - application/json
      description: Get a UserSig credential for Tencent Cloud real-time communication
      parameters:
      - description: UserSig request parameters
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.GetUserSigRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/controllers.ErrorResponse'
      summary: Get Tencent TRTC UserSig
      tags:
      - TencentRTC
securityDefinitions:
  BearerAuth:
    description: 'Enter the token with the `Bearer: ` prefix'
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
